\section{Vissim Network Modelling}
\label{modelling}
The Vissim network used throughout the project is derived from a network originally started COWI and later reworked by DTU Transport students.

COWI's version included O3 from Jyllingevej to the intersection with highway 3 and even further north. In addition highway 3, which runs almost parallel with O3 in this area, was included as well as the minor roads in between.
The network was setup with dynamic assignment of traffic.

\subsection{Modifications \& Additions to Existing Model}

As such the network was missing four intersections of O3 from Jyllingevej to Roskildevej. To establish this section satellite photos from Google Earth was combined with intersection layouts, kindly provided by DRD.

The signal plans and naming conventions for the existing intersections in the COWI model for O3 intersections were adopted when entering the four missing intersections into the network. As for the intersection layout, DRD provided the missing signal plans for these intersections as well.

To prevent side-effects all links not connected to O3 from Herlev Sygehus to Jylligevej were removed as well as all parking lots (DTA zones).

\subsection{Link Inputs}

Due to the arterial nature of the Herlev area there is a natural distinction between major and minut link inputs. The major inputs are positioned in the ends and minor inputs are placed for each minor road.

In the southgoing direction vehicles entering the arterial from highway 3 and the northern extension of O3 are represented by a single input positioned before the intersection at Herlev Sygehus and would be detected by D3.

Northgoing traffic input is defined on the link leading to the Mileparken intersection and is detected by D14. 

The relative size of the major inputs are set according to the relative directional distribution seen in Figure \ref{fig:herlev_props} ie. 45\% northgoing and 55\% southgoing. XXX Insert more specific figure XXX

As the available dataset does not include detectors on the minor sideroads - from either side of the arterial - it is difficult to assess the relative size of the inputs from them. Thus for the remaining roads adjacent to the arterial are defined minor input links of identical size with the exception of the Herlev Sygehus link, which is set to be double the size to match the observations made above.
It is arguable that much traffic enters at the Herlev Hovedgade intersection, but the detected traffic does not indicate that this is significant.

The combined traffic input is set so that in total 20\% arise from the minor roads and the remainder enters from the ends of the arterial. 

XXX Try to find something to back this up eg. from Steen Lauritzens report XXX.

\subsection{Routes}
At every intersection it is possible to follow each adjacent link (ie. turn left, right or go straight through). The lack of a full detector dataset from the area prevents determination of the exact distribution of input on the possible routes. In addition, since it is possible to reach almost every output link from an input link, some simplifying conditions were selected to solve the problem with lack of data and the large number of routes.

It was decided that input from minor roads should turn onto the arterial and choose a north- or southgoing route to the respective end of the arterial with equal probability ie. turn-in traffic does not turn out again but continue along the arterial. In Vissim this effect is accomplished by simply omitting route assignment for vehicles entering on minor links.

To represent turn-out traffic routes choices are inserted for the major inputs only. Thus, from either end of the arterial, there is a route, which turns out, at each intersection in addition to a route going straight-through. 

The proportions for turn-out routes are choosen identical to those of the relative input size for the minor links, which are chosen after the arterial. This coincides with the total traffic input so that 80\% of the traffic goes straight through and 20\% turns out.

\subsection{Signal Plans}
Signal plans define the stage sequence, green duration and how changes between adjacent stages should happen with respect to colors in the from and to stages. For cycle-based signal plans the cycle time must be equal to the sum of green and interstage time from the beginning of the first stage until it begins again.

A single stage defines the signal head colors of one or more signal group, which, in turn, is a group of signal heads operating synchronously.

The simplest signal controller consist of two stages. In  Figure \ref{fig:simple_intersection} the arrows indicate the directions being served green.

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.5]{simple_intersection.png} 
\end{center}
\caption{A simple intersection}
\label{fig:simple_intersection}
\end{figure}

DOGS rely on existing signal and modify the duration of the stage or stages, which serve green in the direction of the arterial. Thus DOGS assume that the stage sequence and interstages are \textit{optimized} so that the time lost in stage changes is minimized and \textit{safe} so that vehicles in eg. left-turning movements have time to leave the intersection before the conflicting direction receives green.

For this project DRD has supplied a number of signal plans for each intersection, developed by TTS. Throughout the plans signal groups in one direction (usually the major one) are named A and B in the perpendicular direction. Names such as At, AV, AtV indicates signal group for the throughgoing, leftgoing (V = venstre (danish) = left) and a combination for the final name variant. Lower case a's and b's indicate a signal group for pedestrians in the major and minor direction resp.

For some intersections a number of alternative plans were supplied. Considering the scope of this project only a single plan was chosen for each intersection and time of day. Generally plans involving pedestrian or bicyclist actuated stages were avoided so as to maximize the potential for traffic signal optimization. It was confirmed by TTS that these types of stages, which are taken in a stochastic manner ie. when a button is pressed, can be devastating to the coordination of traffic signals.

As a final simplifying step it was chosen not to provide signal heads for pedestrians and bicyclists as these types of road users are not being simulated. Pedestrian stages will mostly follow the parallel stages anyway and if this is not the case the stage, which is being denied in favor of the pedestrian stage, will simply receive red for the duration.

The final plans, which are used in the simulation, can be seen in appendix \ref{app:signalplans}.

The actual implementation was done in VAP by running the interstages at the cycle second according to the signal plan, for more details refer to section \ref{vap}.

\subsection{Route Fractions from Traffic Counts}
\label{routefractions}
